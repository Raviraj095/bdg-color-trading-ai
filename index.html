<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Device Authorization Panel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: white;
            text-align: center;
            padding-top: 50px;
        }

        button {
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
        }

        input {
            padding: 10px;
            margin: 10px;
            width: 80%;
        }

        .device-info, .authorized-list {
            margin-top: 20px;
        }

        .device-entry {
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <h1>Device Authorization Panel</h1>

    <!-- Current Device Information -->
    <div class="device-info" id="deviceInfo">Loading your device info...</div>
    <button onclick="authorizeDevice()">Authorize This Device</button>

    <!-- Manual Device Authorization -->
    <h2>Add Another Device</h2>
    <input type="text" id="manualDeviceInput" placeholder="Enter Device Identifier (User-Agent)">
    <button onclick="authorizeManualDevice()">Authorize Device</button>

    <!-- Authorized Devices List -->
    <h2>Authorized Devices</h2>
    <div class="authorized-list" id="authorizedList">No devices authorized yet.</div>

    <script>
        // Get Current Device Identifier (Simplified for matching)
        function getDeviceIdentifier() {
            return `${navigator.platform} | ${navigator.userAgent}`;
        }

        // Display Current Device Info
        function displayCurrentDevice() {
            document.getElementById('deviceInfo').textContent = `Your Device: ${getDeviceIdentifier()}`;
        }

        // Fetch and Display Authorized Devices
        function updateAuthorizedList() {
            const authorizedDevices = JSON.parse(localStorage.getItem('approvedDevices')) || [];
            const listElement = document.getElementById('authorizedList');
            
            if (authorizedDevices.length === 0) {
                listElement.innerHTML = 'No devices authorized yet.';
            } else {
                listElement.innerHTML = authorizedDevices.map((device, index) =>
                    `<div class="device-entry">
                        ${device} 
                        <button onclick="removeDevice(${index})">❌ Remove</button>
                    </div>`).join('');
            }
        }

        // Authorize Current Device
        function authorizeDevice() {
            const currentDevice = getDeviceIdentifier();
            addDevice(currentDevice);
        }

        // Authorize Device Manually
        function authorizeManualDevice() {
            const manualDevice = document.getElementById('manualDeviceInput').value.trim();
            if (manualDevice) {
                addDevice(manualDevice);
                document.getElementById('manualDeviceInput').value = '';
            } else {
                alert('Please enter a valid device identifier.');
            }
        }

        // Add Device to Authorized List (Avoid Duplicates)
        function addDevice(device) {
            let authorizedDevices = JSON.parse(localStorage.getItem('approvedDevices')) || [];

            if (!authorizedDevices.includes(device)) {
                authorizedDevices.push(device);
                localStorage.setItem('approvedDevices', JSON.stringify(authorizedDevices));
                alert('✅ Device Authorized Successfully!');
                updateAuthorizedList();
            } else {
                alert('ℹ️ This device is already authorized.');
            }
        }

        // Remove Device from Authorized List
        function removeDevice(index) {
            let authorizedDevices = JSON.parse(localStorage.getItem('approvedDevices')) || [];
            authorizedDevices.splice(index, 1);
            localStorage.setItem('approvedDevices', JSON.stringify(authorizedDevices));
            updateAuthorizedList();
        }

        // Initialize Panel
        displayCurrentDevice();
        updateAuthorizedList();
    </script>

</body>

</html>
